/*! bootstrap-calendar 2013-09-17 */
https://github.com/Serhioromano/bootstrap-calendar.git
"use strict";Date.prototype.getWeek=function(){var a=new Date(this.getFullYear(),0,1);return Math.ceil(((this.getTime()-a.getTime())/864e5+a.getDay()+1)/7)},Date.prototype.getMonthFormatted=function(){var a=this.getMonth()+1;return 10>a?"0"+a:a},Date.prototype.getDateFormatted=function(){var a=this.getDate();return 10>a?"0"+a:a},String.prototype.format||(String.prototype.format=function(){var a=arguments;return this.replace(/{(\d+)}/g,function(b,c){return"undefined"!=typeof a[c]?a[c]:b})}),function(a){function b(a,b){var c,d,e;e=a,c=a.indexOf("?")<0?"?":"&";for(d in b)e+=c+d+"="+encodeURIComponent(b[d]),c="&";return e}function c(b,c){var d=null!=b.options[c]?b.options[c]:null,e=null!=b.locale[c]?b.locale[c]:null;if("holidays"==c&&b.options.merge_holidays){var f={};return a.extend(!0,f,e?e:i.holidays),d&&a.extend(!0,f,d),f}return null!=d?d:null!=e?e:i[c]}function d(b,e){var f=[],h=c(b,"holidays");for(var i in h)f.push(i+":"+h[i]);if(f.push(e),f=f.join("|"),f in d.cache)return d.cache[f];var j=[];return a.each(h,function(a,b){var c,d=null;if(c=/^(\d\d)-(\d\d)$/.exec(a))d=new Date(e,parseInt(c[2],10)-1,parseInt(c[1],10));else if(c=/^(\d\d)-(\d\d)-(\d\d\d\d)$/.exec(a))parseInt(c[3],10)==e&&(d=new Date(e,parseInt(c[2],10)-1,parseInt(c[1],10)));else if(c=/^easter(([+\-])(\d+))?$/.exec(a))d=g(e,c[1]?parseInt(c[1],10):0);else if(c=/^(\d\d)([+\-])([1-5])\*([0-6])$/.exec(a)){var f=parseInt(c[1],10)-1,h=c[2],i=parseInt(c[3]),k=parseInt(c[4]);switch(h){case"+":for(var l=new Date(e,f,-6);l.getDay()!=k;)l=new Date(l.getFullYear(),l.getMonth(),l.getDate()+1);d=new Date(l.getFullYear(),l.getMonth(),l.getDate()+7*i);break;case"-":for(var l=new Date(e,f+1,7);l.getDay()!=k;)l=new Date(l.getFullYear(),l.getMonth(),l.getDate()-1);d=new Date(l.getFullYear(),l.getMonth(),l.getDate()-7*i)}}else window.console&&console.log&&console.log("Unknown holiday: "+a);d&&j.push({date:d,name:b})}),d.cache[f]=j,d.cache[f]}function e(b,c){return this.options=a.extend(!0,{},h,b),this.setLanguage(this.options.language),this.context=c,c.css("width",this.options.width),this.view(),this}function f(b,c,d,e){b.stopPropagation();var c=a(c),f=c.parents(".cal-cell"),g=c.parents(".cal-row-fluid"),h=f.data("cal-row"),i=0;return c.fadeOut("fast"),d.html(e.options.templates["events-list"]({events:a(".events-list a.event",f)})).slideUp("fast",function(){g.after(d),i=a("[data-cal-date]",f).text(),a("#cal-slide-tick").addClass("tick"+h).show(),d.slideDown("fast",function(){a("body").one("click",function(){d.slideUp("fast"),i=0})})}),a("a.event-item").mouseenter(function(){a("a.event"+a(this).data("event-id")).parents(".cal-cell1").addClass("day-highlight dh-"+a(this).data("event-class"))}),a("a.event-item").mouseleave(function(){a("div.cal-cell1").removeClass("day-highlight dh-"+a(this).data("event-class"))}),i}function g(a,b){var c=a%19,d=Math.floor(a/100),e=a%100,f=Math.floor(d/4),g=d%4,h=Math.floor((d+8)/25),i=Math.floor((d-h+1)/3),j=(19*c+d-f-i+15)%30,k=Math.floor(e/4),l=e%4,m=(32+2*g+2*k-j-l)%7,n=Math.floor((c+11*j+22*m)/451),o=j+m+7*n+114,p=Math.floor(o/31)-1,q=o%31+1;return new Date(a,p,q+(b?b:0),0,0,0)}var h={width:"100%",view:"month",day:"now",events_url:"",tmpl_path:"tmpls/",tmpl_cache:!0,classes:{months:{inmonth:"cal-day-inmonth",outmonth:"cal-day-outmonth",saturday:"cal-day-weekend",sunday:"cal-day-weekend",holidays:"cal-day-holiday",today:"cal-day-today"},week:{workday:"cal-day-workday",saturday:"cal-day-weekend",sunday:"cal-day-weekend",holidays:"cal-day-holiday",today:"cal-day-today"}},views:{year:{slide_events:1,enable:1},month:{slide_events:1,enable:1},week:{enable:1},day:{enable:1}},merge_holidays:!1,onAfterEventsLoad:function(){},onBeforeEventsLoad:function(a){a()},onAfterViewLoad:function(){},events:[],position:{start:new Date,end:new Date},templates:{year:"",month:"",week:"",day:""},stop_cycling:!1},i={first_day:2,holidays:{"01-01":"New Year's Day","01+3*1":"Birthday of Dr. Martin Luther King, Jr.","02+3*1":"Washington's Birthday","05-1*1":"Memorial Day","04-07":"Independence Day","09+1*1":"Labor Day","10+2*1":"Columbus Day","11-11":"Veterans Day","11+4*4":"Thanksgiving Day","25-12":"Christmas"}},j={error_noview:"Calendar: View {0} not found",error_dateformat:'Calendar: Wrong date format {0}. Should be either "now" or "yyyy-mm-dd"',error_loadurl:"Calendar: Event URL is not set",error_where:'Calendar: Wrong navigation direction {0}. Can be only "next" or "prev" or "today"',title_year:"{0}",title_month:"{0} {1}",title_week:"week {0} of {1}",title_day:"{0} {1} {2}, {3}",week:"Week",m0:"January",m1:"February",m2:"March",m3:"April",m4:"May",m5:"June",m6:"July",m7:"August",m8:"September",m9:"October",m10:"November",m11:"December",ms0:"Jan",ms1:"Feb",ms2:"Mar",ms3:"Apr",ms4:"May",ms5:"Jun",ms6:"Jul",ms7:"Aug",ms8:"Sep",ms9:"Oct",ms10:"Nov",ms11:"Dec",d0:"Sunday",d1:"Monday",d2:"Tuesday",d3:"Wednesday",d4:"Thursday",d5:"Friday",d6:"Saturday"};d.cache={},e.prototype.setOptions=function(b){a.extend(this.options,b),"language"in b&&this.setLanguage(b.language)},e.prototype.setLanguage=function(b){window.calendar_languages&&b in window.calendar_languages?(this.locale=a.extend(!0,{},j,calendar_languages[b]),this.options.language=b):(this.locale=j,delete this.options.language)},e.prototype._render=function(){this.context.html(""),this._loadTemplate(this.options.view),this.stop_cycling=!1;var b={};b.events=[],b.cal=this,b.day=1,b.months=1==c(this,"first_day")?[this.locale.d1,this.locale.d2,this.locale.d3,this.locale.d4,this.locale.d5,this.locale.d6,this.locale.d0]:[this.locale.d0,this.locale.d1,this.locale.d2,this.locale.d3,this.locale.d4,this.locale.d5,this.locale.d6];var d=parseInt(this.options.position.start.getTime()),e=parseInt(this.options.position.end.getTime());switch(a.each(this.options.events,function(a,c){parseInt(c.start)<e&&parseInt(c.end)>=d&&b.events.push(c)}),this.options.view){case"month":break;case"week":break;case"day":}b.start=new Date(this.options.position.start.getTime()),b.lang=this.locale,this.context.append(this.options.templates[this.options.view](b)),this._update()},e.prototype._week=function(){this._loadTemplate("week-days");var b={},d=parseInt(this.options.position.start.getTime()),e=parseInt(this.options.position.end.getTime()),f=[],g=this,h=c(this,"first_day");return a.each(this.options.events,function(a,b){parseInt(b.start)<e&&parseInt(b.end)>=d&&(b.start_day=new Date(parseInt(b.start)).getDay(),1==h&&(b.start_day=(b.start_day+6)%7),b.days=b.end-b.start<=864e5?1:(b.end-b.start)/864e5,b.start<d&&(b.days=b.days-(d-b.start)/864e5,b.start_day=0),b.days=Math.ceil(b.days),b.start_day+b.days>7&&(b.days=7-b.start_day),f.push(b))}),b.events=f,b.cal=this,g.options.templates["week-days"](b)},e.prototype._month=function(b){this._loadTemplate("year-month");var c={},d=b+1;c.data_day=this.options.position.start.getFullYear()+"-"+(10>d?"0"+d:d)+"-"+"01",c.month_name=this.locale["m"+b];var e=new Date(this.options.position.start.getFullYear(),b,1,0,0,0),f=parseInt(e.getTime()),g=parseInt(new Date(this.options.position.start.getFullYear(),b+1,0,0,0,0).getTime()),h=[];return a.each(this.options.events,function(a,b){parseInt(b.start)<g&&parseInt(b.end)>=f&&h.push(b)}),c.events=h,this.options.templates["year-month"](c)},e.prototype._day=function(b,d){this._loadTemplate("month-day");var e={tooltip:""},f=this.options.classes.months.outmonth,g=this.options.position.start.getDay();2==c(this,"first_day")?g++:g=0==g?7:g,d=d-g+1;var h=new Date(this.options.position.start.getFullYear(),this.options.position.start.getMonth(),d,0,0,0);d>0&&(f=this.options.classes.months.inmonth);var i=new Date(this.options.position.end.getTime()-1).getDate();if(d+1>i&&(this.stop_cycling=!0),d>i&&(d-=i,f=this.options.classes.months.outmonth),f=a.trim(f+" "+this._getDayClass("months",h)),0>=d){var j=new Date(this.options.position.start.getFullYear(),this.options.position.start.getMonth(),0).getDate();d=j-Math.abs(d),f+=" cal-month-first-row"}var k=this._getHoliday(h);k!==!1&&(e.tooltip=k),e.data_day=h.getFullYear()+"-"+h.getMonthFormatted()+"-"+(10>d?"0"+d:d),e.cls=f,e.day=d;var l=parseInt(h.getTime()),m=parseInt(l+864e5),n=[];return a.each(this.options.events,function(a,b){parseInt(b.start)<m&&parseInt(b.end)>=l&&n.push(b)}),e.events=n,this.options.templates["month-day"](e)},e.prototype._getHoliday=function(b){var c=!1;return a.each(d(this,b.getFullYear()),function(){return this.date.toDateString()==b.toDateString()?(c=this.name,!1):void 0}),c},e.prototype._getHolidayName=function(a){var b=this._getHoliday(a);return b===!1?"":b},e.prototype._getDayClass=function(a,b){var c=this,d=function(b,d){var e;e=c.options.classes&&a in c.options.classes&&b in c.options.classes[a]?c.options.classes[a][b]:"","string"==typeof e&&e.length&&d.push(e)},e=[];b.toDateString()==(new Date).toDateString()&&d("today",e);var f=this._getHoliday(b);switch(f!==!1&&d("holidays",e),b.getDay()){case 0:d("sunday",e);break;case 6:d("saturday",e)}return e.join(" ")},e.prototype.view=function(a){a&&(this.options.view=a),this._init_position(),this._loadEvents(),this._render(),this.options.onAfterViewLoad.call(this,this.options.view)},e.prototype.navigate=function(b,c){var d=a.extend({},this.options.position);if("next"==b)switch(this.options.view){case"year":d.start.setFullYear(this.options.position.start.getFullYear()+1);break;case"month":d.start.setMonth(this.options.position.start.getMonth()+1);break;case"week":d.start.setDate(this.options.position.start.getDate()+7);break;case"day":d.start.setDate(this.options.position.start.getDate()+1)}else if("prev"==b)switch(this.options.view){case"year":d.start.setFullYear(this.options.position.start.getFullYear()-1);break;case"month":d.start.setMonth(this.options.position.start.getMonth()-1);break;case"week":d.start.setDate(this.options.position.start.getDate()-7);break;case"day":d.start.setDate(this.options.position.start.getDate()-1)}else"today"==b?d.start.setTime((new Date).getTime()):a.error(this.locale.error_where.format(b));this.options.day=d.start.getFullYear()+"-"+d.start.getMonthFormatted()+"-"+d.start.getDateFormatted(),this.view(),_.isFunction(c)&&c()},e.prototype._init_position=function(){var b,d,e;if("now"==this.options.day){var f=new Date;b=f.getFullYear(),d=f.getMonth(),e=f.getDate()}else if(this.options.day.match(/^\d{4}-\d{2}-\d{2}$/g)){var g=this.options.day.split("-");b=g[0],d=g[1]-1,e=g[2]}else a.error(this.locale.error_dateformat.format(this.options.day));switch(this.options.view){case"year":this.options.position.start.setTime(new Date(b,0,1).getTime()),this.options.position.end.setTime(new Date(b+1,0,1).getTime());break;case"month":this.options.position.start.setTime(new Date(b,d,1).getTime()),this.options.position.end.setTime(new Date(b,d+1,1).getTime());break;case"day":this.options.position.start.setTime(new Date(b,d,e).getTime()),this.options.position.end.setTime(new Date(b,d,e+1).getTime());break;case"week":var h=new Date(b,d,e),i=h.getDate()-h.getDay();1==c(this,"first_day")&&(i+=1),this.options.position.start.setTime(new Date(b,d,i).getTime()),this.options.position.end.setTime(new Date(b,d,i+7).getTime());break;default:a.error(this.locale.error_noview.format(this.options.view))}return this},e.prototype.getTitle=function(){var a=this.options.position.start;switch(this.options.view){case"year":return this.locale.title_year.format(a.getFullYear());case"month":return this.locale.title_month.format(this.locale["m"+a.getMonth()],a.getFullYear());case"week":return this.locale.title_week.format(a.getWeek(),a.getFullYear());case"day":return this.locale.title_day.format(this.locale["d"+a.getDay()],a.getDate(),this.locale["m"+a.getMonth()],a.getFullYear())}},e.prototype.isToday=function(){var a=(new Date).getTime();return a>this.options.position.start&&a<this.options.position.end},e.prototype.getStartDate=function(){return this.options.position.start},e.prototype.getEndDate=function(){return this.options.position.end},e.prototype._loadEvents=function(){this.options.events_url||a.error(this.locale.error_loadurl);var c=this;this.options.onBeforeEventsLoad.call(this,function(){a.ajax({url:b(c.options.events_url,{from:c.options.position.start.getTime(),to:c.options.position.end.getTime()}),dataType:"json",type:"GET",async:!1}).done(function(b){b.success||a.error(b.error),c.options.events=b.result||[],c.options.onAfterEventsLoad.call(c,b.result)})})},e.prototype._loadTemplate=function(b){if(!this.options.templates[b]){var c=this;a.ajax({url:this.options.tmpl_path+b+".html",dataType:"html",type:"GET",async:!1,cache:this.options.tmpl_cache}).done(function(a){c.options.templates[b]=_.template(a)})}},e.prototype._update=function(){var b=this;a('*[data-toggle="tooltip"]').tooltip({container:"body"}),a("*[data-cal-date]").click(function(){var c=a(this).data("cal-view");b.options.views[c].enable&&(b.options.day=a(this).data("cal-date"),b.view(c))}),a(".cal-cell").dblclick(function(){var c=a("[data-cal-date]",this).data("cal-view");b.options.views[c].enable&&(b.options.day=a("[data-cal-date]",this).data("cal-date"),b.view(c))}),this["_update_"+this.options.view]()},e.prototype._update_day=function(){},e.prototype._update_week=function(){},e.prototype._update_year=function(){this._update_month_year()},e.prototype._update_month=function(){this._update_month_year();var b=a(document.createElement("div")).attr("id","cal-week-box");b.html(this.locale.week);var c=this.options.position.start.getFullYear()+"-"+this.options.position.start.getMonthFormatted()+"-";a(".cal-month-box .cal-row-fluid").each(function(d,e){var f=a(e);f.bind("mouseenter",function(){var d=a(".cal-cell1:first-child .cal-month-day",f),e=d.hasClass("cal-month-first-row")?1:a("[data-cal-date]",d).text();e=10>e?"0"+e:e,b.attr("data-cal-week",c+e).show().appendTo(d)}).bind("mouseleave",function(){b.hide()})});var d=this;b.click(function(){d.options.day=a(this).data("cal-week"),d.view("week")}),a("a.event").mouseenter(function(){a("a.event"+a(this).data("event-id")).parents(".cal-cell1").addClass("day-highlight dh-"+a(this).data("event-class"))}),a("a.event").mouseleave(function(){a("div.cal-cell1").removeClass("day-highlight dh-"+a(this).data("event-class"))})},e.prototype._update_month_year=function(){if(this.options.views[this.options.view].slide_events){var b=0,c=this,d=a(document.createElement("div")).attr("id","cal-day-box").html('<i class="glyphicon glyphicon-chevron-down"></i>');a(".cal-month-day, .cal-year-box .span3").each(function(g,h){a(h).on("mouseenter",function(){0!=a(".events-list",h).length&&(console.log(b),a(h).children("[data-cal-date]").text()!=b&&(d.show().appendTo(h),a(this).on("click",function(a){b=f(a,d,e,c)})))}),a(h).on("mouseleave",function(){d.hide()})});var e=a(document.createElement("div")).attr("id","cal-slide-box");e.hide().click(function(a){a.stopPropagation()}),this._loadTemplate("events-list"),d.click(function(d){b=f(d,a(this),e,c)})}},a.fn.calendar=function(a){return new e(a,this)}}(jQuery);